[dotenv@17.2.3] injecting env (6) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
(node:19204) [SEQUELIZE0004] DeprecationWarning: A boolean value was passed to options.operatorsAliases. This is a no-op with v5 and should be removed.
(Use `node --trace-deprecation ...` to show where the warning was created)
Server is running on port 8080.
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='admins';
Executing (default): CREATE TABLE IF NOT EXISTS `admins` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `username` VARCHAR(255) NOT NULL UNIQUE, `password` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
Executing (default): PRAGMA INDEX_LIST(`admins`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_admins_1`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='diamonds';
Executing (default): CREATE TABLE IF NOT EXISTS `diamonds` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `certificate` VARCHAR(255) NOT NULL UNIQUE, `shape` VARCHAR(255), `carat` DECIMAL(10,2), `color` VARCHAR(255), `clarity` VARCHAR(255), `cut` VARCHAR(255), `lab` VARCHAR(255), `polish` VARCHAR(255), `symmetry` VARCHAR(255), `fluorescence` VARCHAR(255), `crown_height` VARCHAR(255), `pavilion_depth` VARCHAR(255), `girdle_thickness` VARCHAR(255), `culet` VARCHAR(255), `total_depth_percent` VARCHAR(255), `table_percent` VARCHAR(255), `comments` TEXT, `inscription` VARCHAR(255), `price` DECIMAL(10,2) NOT NULL, `commission` DECIMAL(10,2) DEFAULT 0, `status` TEXT DEFAULT 'in_stock', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
Executing (default): PRAGMA INDEX_LIST(`diamonds`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_diamonds_1`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='invoices';
Executing (default): CREATE TABLE IF NOT EXISTS `invoices` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `invoice_date` DATETIME, `customer_name` VARCHAR(255), `total_amount` DECIMAL(10,2), `total_profit` DECIMAL(10,2), `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
Executing (default): PRAGMA INDEX_LIST(`invoices`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='invoice_items';
Executing (default): CREATE TABLE IF NOT EXISTS `invoice_items` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `sale_price` DECIMAL(10,2) NOT NULL, `commission` DECIMAL(10,2) DEFAULT 0, `profit` DECIMAL(10,2) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `invoiceId` INTEGER REFERENCES `invoices` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `saleItemId` INTEGER REFERENCES `diamonds` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `diamondId` INTEGER REFERENCES `diamonds` (`id`) ON DELETE SET NULL ON UPDATE CASCADE);
Executing (default): PRAGMA INDEX_LIST(`invoice_items`)
Drop and re-sync db.
Executing (default): SELECT `id`, `username`, `password`, `createdAt`, `updatedAt` FROM `admins` AS `admin` WHERE `admin`.`username` = 'admin';
Executing (default): INSERT INTO `admins` (`id`,`username`,`password`,`createdAt`,`updatedAt`) VALUES (NULL,$1,$2,$3,$4);
Initial admin created
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT sum(`price`) AS `sum` FROM `diamonds` AS `diamond` WHERE `diamond`.`status` = 'in_stock';
Executing (default): SELECT count(*) AS `count` FROM `diamonds` AS `diamond` WHERE `diamond`.`status` = 'sold';
Executing (default): SELECT SUM(`total_amount`) AS `totalRevenue`, SUM(`total_profit`) AS `totalProfit` FROM `invoices` AS `invoice`;
Executing (default): SELECT sum(`price`) AS `sum` FROM `diamonds` AS `diamond` WHERE `diamond`.`status` = 'in_stock';
Executing (default): SELECT count(*) AS `count` FROM `diamonds` AS `diamond` WHERE `diamond`.`status` = 'sold';
Executing (default): SELECT SUM(`total_amount`) AS `totalRevenue`, SUM(`total_profit`) AS `totalProfit` FROM `invoices` AS `invoice`;
Executing (default): SELECT strftime('%Y-%m', `invoice_date`) AS `date`, SUM(`total_amount`) AS `revenue`, SUM(`total_profit`) AS `profit` FROM `invoices` AS `invoice` GROUP BY strftime('%Y-%m', `invoice_date`) ORDER BY `date` ASC;
Executing (default): SELECT strftime('%Y-%m', `invoice_date`) AS `date`, SUM(`total_amount`) AS `revenue`, SUM(`total_profit`) AS `profit` FROM `invoices` AS `invoice` GROUP BY strftime('%Y-%m', `invoice_date`) ORDER BY `date` ASC;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): INSERT INTO `diamonds` (`id`,`certificate`,`shape`,`carat`,`color`,`clarity`,`lab`,`price`,`commission`,`status`,`createdAt`,`updatedAt`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11);
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): UPDATE `diamonds` SET `price`=$1,`updatedAt`=$2 WHERE `id` = $3
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): BEGIN DEFERRED TRANSACTION;
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond` WHERE `diamond`.`id` = 1;
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): UPDATE `diamonds` SET `status`=$1,`updatedAt`=$2 WHERE `id` = $3
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): INSERT INTO `invoices` (`id`,`invoice_date`,`customer_name`,`total_amount`,`total_profit`,`createdAt`,`updatedAt`) VALUES (NULL,$1,$2,$3,$4,$5,$6);
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): INSERT INTO `invoice_items` (`id`,`sale_price`,`commission`,`profit`,`createdAt`,`updatedAt`,`invoiceId`,`diamondId`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7);
Executing (8433adce-a15b-4404-8c5b-a741e07da72e): COMMIT;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): SELECT `invoice`.`id`, `invoice`.`invoice_date`, `invoice`.`customer_name`, `invoice`.`total_amount`, `invoice`.`total_profit`, `invoice`.`createdAt`, `invoice`.`updatedAt`, `items`.`id` AS `items.id`, `items`.`sale_price` AS `items.sale_price`, `items`.`commission` AS `items.commission`, `items`.`profit` AS `items.profit`, `items`.`createdAt` AS `items.createdAt`, `items`.`updatedAt` AS `items.updatedAt`, `items`.`invoiceId` AS `items.invoiceId`, `items`.`saleItemId` AS `items.saleItemId`, `items`.`diamondId` AS `items.diamondId` FROM `invoices` AS `invoice` LEFT OUTER JOIN `invoice_items` AS `items` ON `invoice`.`id` = `items`.`invoiceId` ORDER BY `invoice`.`createdAt` DESC;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
Executing (default): SELECT `id`, `certificate`, `shape`, `carat`, `color`, `clarity`, `cut`, `lab`, `polish`, `symmetry`, `fluorescence`, `crown_height`, `pavilion_depth`, `girdle_thickness`, `culet`, `total_depth_percent`, `table_percent`, `comments`, `inscription`, `price`, `commission`, `status`, `createdAt`, `updatedAt` FROM `diamonds` AS `diamond`;
